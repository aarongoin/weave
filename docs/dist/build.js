!function e(t,n,o){function r(a,c){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return r(n?n:e)},u,u.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){var o=o||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in o,i=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},a=/constructor/i.test(e.HTMLElement)||e.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},l=function(e){var t=function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()};setTimeout(t,4e4)},u=function(e,t,n){t=[].concat(t);for(var o=t.length;o--;){var r=e["on"+t[o]];if("function"==typeof r)try{r.call(e,n||e)}catch(e){s(e)}}},f=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},p=function(t,s,p){p||(t=f(t));var d,h=this,m=t.type,y="application/octet-stream"===m,b=function(){u(h,"writestart progress write writeend".split(" "))};if(h.readyState=h.INIT,r)return d=n().createObjectURL(t),void setTimeout(function(){o.href=d,o.download=s,i(o),b(),l(d),h.readyState=h.DONE});!function(){if((c||y&&a)&&e.FileReader){var o=new FileReader;return o.onloadend=function(){var t=c?o.result:o.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,h.readyState=h.DONE,b()},o.readAsDataURL(t),void(h.readyState=h.INIT)}if(d||(d=n().createObjectURL(t)),y)e.location.href=d;else{e.open(d,"_blank")||(e.location.href=d)}h.readyState=h.DONE,b(),l(d)}()},d=p.prototype,h=function(e,t,n){return new p(e,t||e.name||"download",n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=f(e)),navigator.msSaveOrOpenBlob(e,t)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,h)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==t&&t.exports?t.exports.saveAs=o:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return o})},{}],2:[function(e,t,n){var o=function(){function e(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var t=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={},i={compressToBase64:function(e){if(null==e)return"";var t=i._compress(e,6,function(e){return n.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:i._decompress(t.length,32,function(o){return e(n,t.charAt(o))})},compressToUTF16:function(e){return null==e?"":i._compress(e,15,function(e){return t(e+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:i._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(e){for(var t=i.compress(e),n=new Uint8Array(2*t.length),o=0,r=t.length;o<r;o++){var a=t.charCodeAt(o);n[2*o]=a>>>8,n[2*o+1]=a%256}return n},decompressFromUint8Array:function(e){if(null===e||void 0===e)return i.decompress(e);for(var n=new Array(e.length/2),o=0,r=n.length;o<r;o++)n[o]=256*e[2*o]+e[2*o+1];var a=[];return n.forEach(function(e){a.push(t(e))}),i.decompress(a.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":i._compress(e,6,function(e){return o.charAt(e)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),i._decompress(t.length,32,function(n){return e(o,t.charAt(n))}))},compress:function(e){return i._compress(e,16,function(e){return t(e)})},_compress:function(e,t,n){if(null==e)return"";var o,r,i,a={},c={},s="",l="",u="",f=2,p=3,d=2,h=[],m=0,y=0;for(i=0;i<e.length;i+=1)if(s=e.charAt(i),Object.prototype.hasOwnProperty.call(a,s)||(a[s]=p++,c[s]=!0),l=u+s,Object.prototype.hasOwnProperty.call(a,l))u=l;else{if(Object.prototype.hasOwnProperty.call(c,u)){if(u.charCodeAt(0)<256){for(o=0;o<d;o++)m<<=1,y==t-1?(y=0,h.push(n(m)),m=0):y++;for(r=u.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&r,y==t-1?(y=0,h.push(n(m)),m=0):y++,r>>=1}else{for(r=1,o=0;o<d;o++)m=m<<1|r,y==t-1?(y=0,h.push(n(m)),m=0):y++,r=0;for(r=u.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&r,y==t-1?(y=0,h.push(n(m)),m=0):y++,r>>=1}f--,0==f&&(f=Math.pow(2,d),d++),delete c[u]}else for(r=a[u],o=0;o<d;o++)m=m<<1|1&r,y==t-1?(y=0,h.push(n(m)),m=0):y++,r>>=1;f--,0==f&&(f=Math.pow(2,d),d++),a[l]=p++,u=String(s)}if(""!==u){if(Object.prototype.hasOwnProperty.call(c,u)){if(u.charCodeAt(0)<256){for(o=0;o<d;o++)m<<=1,y==t-1?(y=0,h.push(n(m)),m=0):y++;for(r=u.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&r,y==t-1?(y=0,h.push(n(m)),m=0):y++,r>>=1}else{for(r=1,o=0;o<d;o++)m=m<<1|r,y==t-1?(y=0,h.push(n(m)),m=0):y++,r=0;for(r=u.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&r,y==t-1?(y=0,h.push(n(m)),m=0):y++,r>>=1}f--,0==f&&(f=Math.pow(2,d),d++),delete c[u]}else for(r=a[u],o=0;o<d;o++)m=m<<1|1&r,y==t-1?(y=0,h.push(n(m)),m=0):y++,r>>=1;f--,0==f&&(f=Math.pow(2,d),d++)}for(r=2,o=0;o<d;o++)m=m<<1|1&r,y==t-1?(y=0,h.push(n(m)),m=0):y++,r>>=1;for(;;){if(m<<=1,y==t-1){h.push(n(m));break}y++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:i._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(e,n,o){var r,i,a,c,s,l,u,f=[],p=4,d=4,h=3,m="",y=[],b={val:o(0),position:n,index:1};for(r=0;r<3;r+=1)f[r]=r;for(a=0,s=Math.pow(2,2),l=1;l!=s;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),a|=(c>0?1:0)*l,l<<=1;switch(a){case 0:for(a=0,s=Math.pow(2,8),l=1;l!=s;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),a|=(c>0?1:0)*l,l<<=1;u=t(a);break;case 1:for(a=0,s=Math.pow(2,16),l=1;l!=s;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),a|=(c>0?1:0)*l,l<<=1;u=t(a);break;case 2:return""}for(f[3]=u,i=u,y.push(u);;){if(b.index>e)return"";for(a=0,s=Math.pow(2,h),l=1;l!=s;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),a|=(c>0?1:0)*l,l<<=1;switch(u=a){case 0:for(a=0,s=Math.pow(2,8),l=1;l!=s;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),a|=(c>0?1:0)*l,l<<=1;f[d++]=t(a),u=d-1,p--;break;case 1:for(a=0,s=Math.pow(2,16),l=1;l!=s;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),a|=(c>0?1:0)*l,l<<=1;f[d++]=t(a),u=d-1,p--;break;case 2:return y.join("")}if(0==p&&(p=Math.pow(2,h),h++),f[u])m=f[u];else{if(u!==d)return null;m=i+i.charAt(0)}y.push(m),f[d++]=i+m.charAt(0),p--,i=m,0==p&&(p=Math.pow(2,h),h++)}}};return i}();"function"==typeof define&&define.amd?define(function(){return o}):void 0!==t&&null!=t&&(t.exports=o)},{}],3:[function(e,t,n){!function(){"use strict";function e(){}function n(t,n){var o,r,i,a,c=M;for(a=arguments.length;a-- >2;)P.push(arguments[a]);for(n&&null!=n.children&&(P.length||P.push(n.children),delete n.children);P.length;)if((r=P.pop())&&void 0!==r.pop)for(a=r.length;a--;)P.push(r[a]);else r!==!0&&r!==!1||(r=null),(i="function"!=typeof t)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(i=!1)),i&&o?c[c.length-1]+=r:c===M?c=[r]:c.push(r),o=i;var s=new e;return s.nodeName=t,s.children=c,s.attributes=null==n?void 0:n,s.key=null==n?void 0:n.key,void 0!==T.vnode&&T.vnode(s),s}function o(e,t){for(var n in t)e[n]=t[n];return e}function r(e,t){return n(e.nodeName,o(o({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}function i(e){!e.__d&&(e.__d=!0)&&1==B.push(e)&&(T.debounceRendering||setTimeout)(a)}function a(){var e,t=B;for(B=[];e=t.pop();)e.__d&&S(e)}function c(e,t,n){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&s(e,t.nodeName):n||e._componentConstructor===t.nodeName}function s(e,t){return e.__n===t||e.nodeName.toLowerCase()===t.toLowerCase()}function l(e){var t=o({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function u(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.__n=e,n}function f(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e,t,n,o,r){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),o&&o(e);else if("class"!==t||r)if("style"===t){if(o&&"string"!=typeof o&&"string"!=typeof n||(e.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof n)for(var i in n)i in o||(e.style[i]="");for(var i in o)e.style[i]="number"==typeof o[i]&&z.test(i)===!1?o[i]+"px":o[i]}}else if("dangerouslySetInnerHTML"===t)o&&(e.innerHTML=o.__html||"");else if("o"==t[0]&&"n"==t[1]){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),o?n||e.addEventListener(t,h,a):e.removeEventListener(t,h,a),(e.__l||(e.__l={}))[t]=o}else if("list"!==t&&"type"!==t&&!r&&t in e)d(e,t,null==o?"":o),null!=o&&o!==!1||e.removeAttribute(t);else{var c=r&&t!==(t=t.replace(/^xlink\:?/,""));null==o||o===!1?c?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof o&&(c?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),o):e.setAttribute(t,o))}else e.className=o||""}function d(e,t,n){try{e[t]=n}catch(e){}}function h(e){return this.__l[e.type](T.event&&T.event(e)||e)}function m(){for(var e;e=L.pop();)T.afterMount&&T.afterMount(e),e.componentDidMount&&e.componentDidMount()}function y(e,t,n,o,r,i){N++||(W=null!=r&&void 0!==r.ownerSVGElement,H=null!=e&&!("__preactattr_"in e));var a=b(e,t,n,o,i);return r&&a.parentNode!==r&&r.appendChild(a),--N||(H=!1,i||m()),a}function b(e,t,n,o,r){var i=e,a=W;if(null==t&&(t=""),"string"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||r)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),v(e,!0))),i.__preactattr_=!0,i;if("function"==typeof t.nodeName)return k(e,t,n,o);if(W="svg"===t.nodeName||"foreignObject"!==t.nodeName&&W,(!e||!s(e,String(t.nodeName)))&&(i=u(String(t.nodeName),W),e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),v(e,!0)}var c=i.firstChild,l=i.__preactattr_||(i.__preactattr_={}),f=t.children;return!H&&f&&1===f.length&&"string"==typeof f[0]&&null!=c&&void 0!==c.splitText&&null==c.nextSibling?c.nodeValue!=f[0]&&(c.nodeValue=f[0]):(f&&f.length||null!=c)&&g(i,f,n,o,H||null!=l.dangerouslySetInnerHTML),j(i,t.attributes,l),W=a,i}function g(e,t,n,o,r){var i,a,s,l,u=e.childNodes,p=[],d={},h=0,m=0,y=u.length,g=0,w=t?t.length:0;if(0!==y)for(var j=0;j<y;j++){var x=u[j],_=x.__preactattr_,O=w&&_?x._component?x._component.__k:_.key:null;null!=O?(h++,d[O]=x):(_||(void 0!==x.splitText?!r||x.nodeValue.trim():r))&&(p[g++]=x)}if(0!==w)for(var j=0;j<w;j++){s=t[j],l=null;var O=s.key;if(null!=O)h&&void 0!==d[O]&&(l=d[O],d[O]=void 0,h--);else if(!l&&m<g)for(i=m;i<g;i++)if(void 0!==p[i]&&c(a=p[i],s,r)){l=a,p[i]=void 0,i===g-1&&g--,i===m&&m++;break}l=b(l,s,n,o),l&&l!==e&&(j>=y?e.appendChild(l):l!==u[j]&&(l===u[j+1]?f(u[j]):e.insertBefore(l,u[j]||null)))}if(h)for(var j in d)void 0!==d[j]&&v(d[j],!1);for(;m<=g;)void 0!==(l=p[g--])&&v(l,!1)}function v(e,t){var n=e._component;n?C(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t!==!1&&null!=e.__preactattr_||f(e),w(e))}function w(e){for(e=e.lastChild;e;){var t=e.previousSibling;v(e,!0),e=t}}function j(e,t,n){var o;for(o in n)t&&null!=t[o]||null==n[o]||p(e,o,n[o],n[o]=void 0,W);for(o in t)"children"===o||"innerHTML"===o||o in n&&t[o]===("value"===o||"checked"===o?e[o]:n[o])||p(e,o,n[o],n[o]=t[o],W)}function x(e){var t=e.constructor.name;(R[t]||(R[t]=[])).push(e)}function _(e,t,n){var o,r=R[e.name];if(e.prototype&&e.prototype.render?(o=new e(t,n),I.call(o,t,n)):(o=new I(t,n),o.constructor=e,o.render=O),r)for(var i=r.length;i--;)if(r[i].constructor===e){o.__b=r[i].__b,r.splice(i,1);break}return o}function O(e,t,n){return this.constructor(e,n)}function E(e,t,n,o,r){e.__x||(e.__x=!0,(e.__r=t.ref)&&delete t.ref,(e.__k=t.key)&&delete t.key,!e.base||r?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,o),o&&o!==e.context&&(e.__c||(e.__c=e.context),e.context=o),e.__p||(e.__p=e.props),e.props=t,e.__x=!1,0!==n&&(1!==n&&T.syncComponentUpdates===!1&&e.base?i(e):S(e,1,r)),e.__r&&e.__r(e))}function S(e,t,n,r){if(!e.__x){var i,a,c,s=e.props,u=e.state,f=e.context,p=e.__p||s,d=e.__s||u,h=e.__c||f,b=e.base,g=e.__b,w=b||g,j=e._component,x=!1;if(b&&(e.props=p,e.state=d,e.context=h,2!==t&&e.shouldComponentUpdate&&e.shouldComponentUpdate(s,u,f)===!1?x=!0:e.componentWillUpdate&&e.componentWillUpdate(s,u,f),e.props=s,e.state=u,e.context=f),e.__p=e.__s=e.__c=e.__b=null,e.__d=!1,!x){i=e.render(s,u,f),e.getChildContext&&(f=o(o({},f),e.getChildContext()));var O,k,I=i&&i.nodeName;if("function"==typeof I){var D=l(i);a=j,a&&a.constructor===I&&D.key==a.__k?E(a,D,1,f,!1):(O=a,e._component=a=_(I,D,f),a.__b=a.__b||g,a.__u=e,E(a,D,0,f,!1),S(a,1,n,!0)),k=a.base}else c=w,O=j,O&&(c=e._component=null),(w||1===t)&&(c&&(c._component=null),k=y(c,i,f,n||!b,w&&w.parentNode,!0));if(w&&k!==w&&a!==j){var P=w.parentNode;P&&k!==P&&(P.replaceChild(k,w),O||(w._component=null,v(w,!1)))}if(O&&C(O),e.base=k,k&&!r){for(var M=e,z=e;z=z.__u;)(M=z).base=k;k._component=M,k._componentConstructor=M.constructor}}if(!b||n?L.unshift(e):x||(m(),e.componentDidUpdate&&e.componentDidUpdate(p,d,h),T.afterUpdate&&T.afterUpdate(e)),null!=e.__h)for(;e.__h.length;)e.__h.pop().call(e);N||r||m()}}function k(e,t,n,o){for(var r=e&&e._component,i=r,a=e,c=r&&e._componentConstructor===t.nodeName,s=c,u=l(t);r&&!s&&(r=r.__u);)s=r.constructor===t.nodeName;return r&&s&&(!o||r._component)?(E(r,u,3,n,o),e=r.base):(i&&!c&&(C(i),e=a=null),r=_(t.nodeName,u,n),e&&!r.__b&&(r.__b=e,a=null),E(r,u,1,n,o),e=r.base,a&&e!==a&&(a._component=null,v(a,!1))),e}function C(e){T.beforeUnmount&&T.beforeUnmount(e);var t=e.base;e.__x=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?C(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.__b=t,f(t),x(e),w(t)),e.__r&&e.__r(null)}function I(e,t){this.__d=!0,this.context=t,this.props=e,this.state=this.state||{}}function D(e,t,n){return y(n,e,{},!1,t,!1)}var T={},P=[],M=[],z=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,B=[],L=[],N=0,W=!1,H=!1,R={};o(I.prototype,{setState:function(e,t){var n=this.state;this.__s||(this.__s=o({},n)),o(n,"function"==typeof e?e(n,this.props):e),t&&(this.__h=this.__h||[]).push(t),i(this)},forceUpdate:function(e){e&&(this.__h=this.__h||[]).push(e),S(this,2)},render:function(){},cueRender:function(){i(this)}});var A={h:n,createElement:n,cloneElement:r,Component:I,render:D,rerender:a,options:T};void 0!==t?t.exports=A:self.preact=A}()},{}],4:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();e("./polyfills.js");var c="v0.9.0",s=e("preact"),l=e("./components/ProjectModal.js"),u=e("./components/PrintModal.js"),f=e("./components/WelcomeModal.js"),p=e("./components/WeaveView.js"),d=e("./components/SceneWriter.js"),h=e("./colors.js"),m=e("./bind.js"),y=e("lz-string"),b=e("./Sourcery.js"),g=e("./actions.js"),v={app:{minWidth:"100vw"},titleSpace:{zIndex:22,position:"absolute",left:0,top:0,height:"8rem",display:"flex",justifyContent:"center",alignItems:"center"},projectButton:{minHeight:"2.5rem",padding:"0.5rem 0.75rem",width:"7rem",outline:"none",backgroundColor:"#fff",border:"none",color:"#000",fontSize:"1.2rem",cursor:"pointer"}},w=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.state={currentView:1,focusedScene:null,modalView:0,project:b.getLocal("weave-project")},i.state.project?i.state.project=JSON.parse(y.decompressFromUTF16(i.state.project)):i.state.project={p:"Welcome to Weave",a:"Aaron Goin",w:4,c:1,s:[{h:"Chapter One",s:[{h:"Introduction to Weave",b:"Welcome to Weave!",w:4,l:"Bedroom"}]}],t:[{n:"Harry Potter",c:h.random()}]},i.state.project.v&&i.state.project.v===c||(i.state.modalView=4),m(i),i}return i(t,e),a(t,[{key:"countProject",value:function(){return{wordCount:this.state.project.s.reduce(function(e,t){return e+t.s.reduce(function(e,t){return t?e+t.w:e},0)},0),sceneCount:this.state.project.s.reduce(function(e,t){return e+t.s.reduce(function(e,t){return t?e+1:e},0)},0)}}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"renderModal",value:function(e,t){var n=this;switch(t.modalView){case 0:return"";case 1:return s.createElement(l,{project:t.project,onPrint:function(){return n.setState({modalView:2})},onDone:function(){return n.setState({modalView:0})}});case 2:return s.createElement(u,{project:t.project,onDone:function(){return n.setState({modalView:0})}});case 3:return s.createElement(HelpModal,{project:t.project,onDone:function(){return n.setState({modalView:0})}});case 4:return s.createElement(f,{project:t.project,onDone:function(){return n.setState({modalView:0})}})}}},{key:"render",value:function(e,t){var n=this;switch(t.currentView){case 1:return s.createElement("div",{id:"app",style:t.modalView?Object.assign({overflow:"hidden"},v.app):v.app},s.createElement(p,{project:t.project,focusedScene:t.focusedScene,onSelect:function(e){return n.setState({focusedScene:e})},onDeselect:function(){return n.setState({focusedScene:null})},onEditScene:function(e){return n.setState({currentView:2,focusedScene:e})}}),s.createElement("div",{style:v.titleSpace},s.createElement("button",{style:v.projectButton,onClick:function(){return n.setState({modalView:1})}},t.project.p.length?t.project.p:"Project Title")),this.renderModal(e,t));case 2:return s.createElement("div",{id:"app",style:t.modalView?Object.assign({overflow:"hidden"},v.app):v.app},s.createElement(d,{coords:t.focusedScene,scene:t.project.s[t.focusedScene.sliceIndex].s[t.focusedScene.sceneIndex],thread:t.project.t[t.focusedScene.sceneIndex],onDone:function(){return n.setState({currentView:1,focusedScene:null})}}))}}},{key:"onResize",value:function(){this.cueRender()}},{key:"do",value:function(e,t){this.state.project=g[e](t,this.state.project),this.state.project=Object.assign({},this.state.project,this.countProject()),this.cueRender(),this.save()}},{key:"openProject",value:function(e){e=JSON.parse(e),this.setState(e),this.save()}},{key:"save",value:function(){b.setLocal("weave-project",y.compressToUTF16(JSON.stringify(this.state.project)))}},{key:"getChildContext",value:function(){var e=this;return{thread:function(t){return e.state.project.t[t]},do:this.do}}}]),t}(s.Component);s.options.debounceRendering=window.requestAnimationFrame,s.render(s.createElement(w,null),document.body)},{"./Sourcery.js":5,"./actions.js":6,"./bind.js":7,"./colors.js":8,"./components/PrintModal.js":19,"./components/ProjectModal.js":20,"./components/SceneWriter.js":22,"./components/WeaveView.js":28,"./components/WelcomeModal.js":29,"./polyfills.js":30,"lz-string":2,preact:3}],5:[function(e,t,n){"use strict";t.exports={checkStatus:function(e){var t={local:!1,online:!1};try{window.localStorage.setItem("checkStatus","a"),window.localStorage.getItem("checkStatus"),window.localStorage.removeItem("checkStatus"),t.local=!0}catch(e){}return t.online=window.navigator.onLine,t},getLocal:function(e){return window.localStorage.getItem(e)},setLocal:function(e,t){var n=!0;if(void 0===t)window.localStorage.removeItem(e);else try{window.localStorage.setItem(e,t)}catch(e){n=!1}return n}}},{}],6:[function(e,t,n){"use strict";t.exports={NewProject:function(e,t){return{p:"",a:"",w:0,c:0,s:[],t:[]}},ImportProject:function(e,t){return e.project},ModifyProjectTitle:function(e,t){var n=e.title;return t.p=n,t},ModifyProjectAuthor:function(e,t){var n=e.author;return t.a=n,t},NewSlice:function(e,t){var n=e.atIndex;return t.s=Object.assign([],t.s),t.s.splice(n,0,{h:"",s:t.t.map(function(){return null})}),t},MoveSliceHeader:function(e,t){var n=e.from,o=e.to;return t.s[o].h=t.s[n].h,t.s[n].h="",t},DeleteSlice:function(e,t){var n=e.atIndex;return t.s=Object.assign([],t.s),t.s.splice(n,1),t},ModifySliceHeader:function(e,t){var n=e.atIndex,o=e.header;return t.s[n].h=o,t},NewScene:function(e,t){return t.s=Object.assign([],t.s),t.s[e.sliceIndex].s.splice(e.sceneIndex,1,{h:"",b:"",w:0,l:""}),t},DeleteScene:function(e,t){return t.s=Object.assign([],t.s),t.s[e.sliceIndex].s[e.sceneIndex]=null,t},ModifySceneHead:function(e,t){return t.s=Object.assign([],t.s),t.s[e.sliceIndex].s[e.sceneIndex].h=e.newHead,t},ModifySceneBody:function(e,t){t.s=Object.assign([],t.s);var n=t.s[e.sliceIndex].s[e.sceneIndex];return n.b=e.newBody,n.w=e.wc,t},ModifySceneLocation:function(e,t){return t.s=Object.assign([],t.s),scene=t.s[e.sliceIndex].s[e.sceneIndex].l=e.newLocation,t},MoveScene:function(e,t){return t.s=Object.assign([],t.s),t.s[e.to.sliceIndex].s[e.to.sceneIndex]=t.s[e.from.sliceIndex].s[e.from.sceneIndex],t.s[e.from.sliceIndex].s[e.from.sceneIndex]=null,t},NewThread:function(e,t){var n=t.s.length;for(t.t=Object.assign([],t.t),t.s=Object.assign([],t.s),t.t.push({c:e.color,n:""});n--;)t.s[n].s.push(null);return t},DeleteThread:function(e,t){var n=t.s.length;for(t.t=Object.assign([],t.t),t.s=Object.assign([],t.s),t.t.splice(e.atIndex,1);n--;)t.s[n].s.splice(e.atIndex,1);return t},MoveThread:function(e,t){var n,o=t.s.length;for(t.t=Object.assign([],t.t),t.s=Object.assign([],t.s),t.t.splice(e.toIndex,0,t.t.splice(e.fromIndex,1)[0]);o--;)n=t.s[o].s,n.splice(e.toIndex,0,n.splice(e.fromIndex,1)[0]);return t},ModifyThreadName:function(e,t){return t.t=Object.assign([],t.t),t.t[e.atIndex].n=e.newName,t},ModifyThreadColor:function(e,t){return t.t=Object.assign([],t.t),t.t[e.atIndex].c=e.color,t}}},{}],7:[function(e,t,n){"use strict";t.exports=function(e){for(var t,n=e.constructor.prototype,o=Object.getOwnPropertyNames(n);t=o.pop();)"function"==typeof n[t]&&"constructor"!==t&&(e[t]=e[t].bind(e))}},{}],8:[function(e,t,n){"use strict";var o=["#666666","#999999","#b21f35","#d82735","#ff7435","#ffa135","#ffcb35","#00753a","#009e47","#16dd36","#0052a5","#0079e7","#06a9fc","#681e7e","#7d3cb5","#bd7af6"];t.exports={palette:o,random:function(e){return"hsl("+12*(30*Math.random()>>0)+", 75%, 45%)"}}},{}],9:[function(e,t,n){"use strict";function o(e){var t=e.match(/[WM]/g),n=e.match(/[Itrlij!. ]/g);return t=t?t.length:0,n=n?n.length:0,e.length+1.2*t-.3*n}function r(e,t){return i.createElement("div",{id:"toolbar",style:a.toolbar},i.createElement("menu",{type:"toolbar",style:a.menu,ref:e.ref},e.groups.map(function(t){return i.createElement("ul",{style:a.ul},t.map(function(t){return t.custom?t.custom:t.onClick||t.onHold?i.createElement("li",{style:a.li},i.createElement("button",{style:t.style?Object.assign({},a.item,t.style):a.item,onClick:function(e){e.target.style.color=t.style?t.style.color||"#fff":"#fff",t.onClick&&t.onClick(e),t.timer&&(clearTimeout(t.timer),t.timer=void 0)},onMouseDown:function(e){e.target.style.color="#777",t.onHold&&(t.timer=setTimeout(t.onHold,1e3,e))},name:t.name},t.icon?i.createElement("img",{style:a.img,src:t.icon}):t.value)):t.onInput?i.createElement("li",{style:a.li},i.createElement("input",{style:t.style?Object.assign({},a.input,t.style):a.input,type:"text",placeholder:t.placeholder,maxLength:40,size:Math.max(o(t.value.length?t.value:e.placeholder||""),20),onInput:t.onInput,value:t.value})):i.createElement("li",{style:Object.assign({},a.li,a.text,t.style?t.style:{})},i.createElement("span",{style:a.span},t.value))}))})))}var i=e("preact"),a={toolbar:{zIndex:"20",position:"fixed",top:"0",left:"0",right:"0",width:"100vw",border:"none",borderBottom:"thin solid #777",backgroundColor:"#000000",color:"#fff"},menu:{width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-between"},ul:{display:"flex",justifyContent:"space-between",alignItems:"center",listStyle:"none"},li:{display:"inline-flex",justifyContent:"center",alignItems:"center",margin:"0 0.5rem"},item:{height:"2.5rem",padding:"0 0.75rem",border:"none",outline:"none",backgroundColor:"#000000",color:"#fff",fontSize:"1.2rem",cursor:"pointer"},img:{width:"1.2rem",height:"1.2rem"},span:{paddingTop:"1rem",height:"2rem"},text:{fontSize:"1rem"},input:{height:"2rem",maxWidth:"95vw",padding:"0 0.75rem",border:"none",borderBottom:"thin solid #fff",outline:"none",backgroundColor:"#000",fontSize:"1.2rem",color:"#fff"}};r.main=function(e,t){return{opened:e,closed:t}},r.input=function(e,t,n,o){return{placeholder:e,value:t,onInput:n,style:o?o:void 0}},r.text=function(e,t){return{value:e,style:t?t:void 0}},r.btn=function(e,t,n){return{value:e,onClick:t,style:n?n:void 0}},r.deleteBtn=function(e){return{value:"delete",style:{color:"#f00",transition:"color 1s"},onHold:e}},t.exports=r},{preact:3}],10:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s={btn:{position:"relative",zIndex:25,width:"2rem",height:"2rem",borderRadius:"1rem",border:"none",outline:"none",backgroundColor:"#eee",color:"#f00",fontSize:"1.2rem",fontWeight:"bold",transition:"color 1s",cursor:"pointer"}},l=function(e){function t(e,n){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"render",value:function(e){var t=this;return c.createElement("button",{style:e.style?Object.assign({},s.btn,e.style):s.btn,onClick:function(e){e.target.style.color="#f00",t.timer&&(clearTimeout(t.timer),t.timer=void 0)},onMouseDown:function(n){n.target.style.color="#777",e.onHold&&(t.timer=setTimeout(e.onHold,1e3,n))}},"X")}}]),t}(c.Component);t.exports=l},{preact:3}],11:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("../bind.js"),l=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s(i),i}return i(t,e),a(t,[{key:"render",value:function(e,t){return c.createElement("div",{style:e.style,draggable:!0,onDrag:this.onDrag,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,onDragExit:this.onDragExit,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},e.children)}},{key:"onDrag",value:function(e){this.props.onDrag&&this.props.onDrag(e)}},{key:"onDragStart",value:function(e){var t=JSON.stringify(this.props.payload||"payload");e.dataTransfer.effectAllowed=this.props.effect,e.dataTransfer.setData(this.props.type,t),this.props.onDragStart&&this.props.onDragStart(e)}},{key:"onDragEnd",value:function(e){this.props.onDragEnd&&this.props.onDragEnd(e)}},{key:"onDragExit",value:function(e){this.props.onDragExit&&this.props.onDragExit(e)}},{key:"onMouseDown",value:function(e){this.props.onMouseDown&&this.props.onMouseDown(e)}},{key:"onMouseUp",value:function(e){this.props.onMouseUp&&this.props.onMouseUp(e)}}]),t}(c.Component);t.exports=l},{"../bind.js":7,preact:3}],12:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("../bind.js"),l=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s(i),i}return i(t,e),a(t,[{key:"render",value:function(e,t){return c.createElement("div",{style:e.style,onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onDrop},e.children)}},{key:"onDrop",value:function(e){var t=JSON.parse(e.dataTransfer.getData(this.props.type));this.props.onDrop&&this.props.onDrop(t,e)}},{key:"onDragEnter",value:function(e){e.dataTransfer.types[0]===this.props.type&&(e.dataTransfer.dropEffect=this.props.effect,e.preventDefault(),this.props.onDragEnter&&this.props.onDragEnter(e))}},{key:"onDragOver",value:function(e){e.dataTransfer.types[0]===this.props.type&&(e.dataTransfer.dropEffect=this.props.effect,e.preventDefault(),this.props.onDragOver&&this.props.onDragOver(e))}},{key:"onDragLeave",value:function(e){this.props.onDragLeave&&this.props.onDragLeave(e)}}]),t}(c.Component);t.exports=l},{"../bind.js":7,preact:3}],13:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
;return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("../bind.js"),l={editBox:{outline:"none",border:"none",overflow:"hidden",resize:"none"}},u=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.state={value:e.value,style:Object.assign({},l.editBox,{height:e.baseHeight})},s(i),i}return i(t,e),a(t,[{key:"render",value:function(e,t){var n=Object.assign({},e.style,t.style);return c.createElement("textarea",{style:n,maxlength:e.maxlength,placeholder:e.placeholder,onInput:this.onInput,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,value:t.value})}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.state.value&&this.setState({value:e.value,style:Object.assign({},l.editBox,{height:e.baseHeight})},this.resize)}},{key:"componentDidMount",value:function(){this.doResize(),window.addEventListener("resize",this.doResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.doResize)}},{key:"onInput",value:function(e){this.state.value=e.target.value,this.props.onInput&&this.props.onInput(e),this.doResize()}},{key:"doResize",value:function(){this.state.style.height=this.props.baseHeight,this.forceUpdate(this.resize)}},{key:"resize",value:function(){this.state.style.height=this.base.scrollHeight+"px",this.forceUpdate()}}]),t}(c.Component);t.exports=u},{"../bind.js":7,preact:3}],14:[function(e,t,n){"use strict";var o=e("preact"),r=new FileReader;t.exports=function(e){return o.createElement("input",{type:"file",accept:".weave",style:{position:"absolute",visibility:"hidden",top:"-50",left:"-50"},onchange:function(t){r.onloadend=function(){return e.onChange(r.result)},r.readAsText(t.target.files[0])}})}},{preact:3}],15:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("./DeleteButton.js"),l=(e("./LocationLabel.js"),e("../bind.js")),u=e("./ExpandingTextarea.js"),f={box:{maxWidth:"50rem",backgroundColor:"#fff",color:"#222",display:"flex",flexDirection:"column",justifyContent:"space-around",alignItems:"stretch",width:"14rem",position:"relative",top:"0.2rem",maxHeight:"13rem",margin:"0.2rem",border:"0 solid rgba(0,0,0,0)"},textarea:{fontSize:"1.1rem",margin:"0.75rem",maxHeight:"3.75rem",textAlign:"center"},deleteButton:{zIndex:25,fontSize:"0.9rem",position:"absolute",bottom:"-2.5rem",left:"5.9rem",cursor:"pointer"}},p=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.state={selected:!1,value:e.value},l(i),i}return i(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({value:e.value,selected:this.state.selected})}},{key:"render",value:function(e,t){var n=this;return c.createElement("div",{style:t.value.length?f.box:Object.assign({},f.box,{width:"3rem"})},c.createElement(u,{style:f.textarea,maxLength:250,baseHeight:"1.3rem",placeholder:"...",value:t.value,onFocus:function(){return n.setState({selected:!0})},onBlur:this.onBlur,onInput:function(e){return n.setState({value:e.target.value})},onChange:this.onChange,ref:function(e){return n.el=e}}),t.selected?c.createElement(s,{ref:function(e){return n.delBtn=e},style:t.value.length?f.deleteButton:Object.assign({},f.deleteButton,{left:"0.5rem"}),onHold:function(){n.setState({selected:!1}),n.context.do("DeleteSlice",{atIndex:e.id})}}):"")}},{key:"onDragStart",value:function(){event.dataTransfer.effectAllowed="move",event.dataTransfer.setData("header","header"),this.el.base.blur(),this.props.onHeaderDrag&&this.props.onHeaderDrag(this.props.id)}},{key:"onChange",value:function(e){this.context.do("ModifySliceHeader",{atIndex:this.props.id,header:this.state.value})}},{key:"onBlur",value:function(e){var t=this;setTimeout(function(){t.delBtn&&!t.delBtn.timer&&t.setState({selected:!1})},100)}}]),t}(c.Component);t.exports=p},{"../bind.js":7,"./DeleteButton.js":10,"./ExpandingTextarea.js":13,"./LocationLabel.js":16,preact:3}],16:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s={editor:{fontSize:"0.9rem",padding:"0.5rem",height:"1rem",border:"none",outline:"none",background:"rgba(0,0,0,0)",color:"#fff"}},l=function(e){function t(e,n){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"render",value:function(e,t,n){return c.createElement("input",{type:"text",style:e.style?Object.assign({},s.editor,e.style):s.editor,maxLength:"50",size:20,value:e.value,placeholder:"location",onInput:function(t){e.onInput(t.target.value)}})}}]),t}(c.Component);t.exports=l},{preact:3}],17:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s={outer:{zIndex:30,position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"flex-start",overflow:"scroll"},inner:{backgroundColor:"#fff",display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",padding:"1.5rem",marginTop:"1rem"}},l=function(e){function t(e,n){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"render",value:function(e,t){return c.createElement("div",{style:s.outer,onClick:e.dismiss},c.createElement("div",{style:s.inner,onClick:function(e){return e.stopPropagation()}},e.children))}}]),t}(c.Component);t.exports=l},{preact:3}],18:[function(e,t,n){"use strict";var o=e("preact"),r={space:{zIndex:10,height:"5.25rem",width:"7rem",display:"flex",justifyContent:"center",alignItems:"flex-end"},button:{margin:"0 3rem",padding:"0.2rem 0.6rem",marginBottom:"0.1rem",fontSize:"1.2rem",color:"#fff",border:"none",outline:"none",cursor:"pointer",textAlign:"center",borderRadius:"1rem",backgroundColor:"rgba(0,0,0,0)"}};t.exports=function(e){return o.createElement("div",{style:e.halfWidth?Object.assign({},r.space,{width:"3.5rem"}):r.space},o.createElement("button",{onclick:e.onClick,style:r.button,onmouseenter:function(e){return e.target.style.backgroundColor="rgba(255,255,255,0.2)"},onmouseleave:function(e){return e.target.style.backgroundColor="rgba(0,0,0,0)"}},"+"))}},{preact:3}],19:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("file-saver"),l=e("./ModalView.js"),u=e("../bind.js"),f={scene:{display:"flex",justifyContent:"space-around",fontSize:"0.9rem",alignItems:"center",padding:"0.5rem",margin:"0.5rem 0.5rem",width:"20rem"},span:{minWidth:"5rem",marginRight:"1rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},row:{display:"flex",justifyContent:"space-around",alignItems:"center",width:"100%"},input:{zIndex:"11",color:"#000",maxWidth:"14rem",outline:"none",fontSize:"1rem",border:"none",textAlign:"center",padding:"0.25rem",marginTop:"0.5rem"},thread:{height:"2rem",padding:"0 0.75rem",border:"none",outline:"none",backgroundColor:"#000000",color:"#fff",fontSize:"1rem",cursor:"pointer",borderRadius:"1rem"},sliceSection:{minWidth:"20rem"},threadSection:{marginBottom:"1rem"},date:{color:"#fff",fontSize:"0.9rem"},item:{height:"2.5rem",padding:"0 0.75rem",marginTop:"1rem",border:"none",outline:"none",backgroundColor:"#fff",color:"#000",fontSize:"1.2rem",cursor:"pointer"}},p=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.state={threads:[],filtered:[],deselected:[]},i.filter(),u(i),i}return i(t,e),a(t,[{key:"render",value:function(e,t){var n=this,o=this.select;return c.createElement(l,{dismiss:e.onDone},c.createElement("div",{"data-is":"threads",style:f.threadSection},e.project.t.reduce(function(e,o,r){return o.n.length?e.concat([c.createElement("button",{"data-id":r,style:Object.assign({},f.thread,{backgroundColor:t.threads.indexOf(r)!==-1?o.c:"#777"}),onClick:n.toggleFilter},o.n)]):e},[])),c.createElement("div",{"data-is":"slices",style:f.sliceSection},t.filtered.map(function(e,n){return c.createElement("div",{style:Object.assign({opacity:t.deselected.indexOf(n)!==-1?"0.5":"1"},f.scene,e.style),onClick:function(){return o(n)}},e.values.map(function(e){return c.createElement("span",{style:f.span},e)}))})),c.createElement("div",{style:f.row},c.createElement("button",{style:f.item,onClick:function(){e.onDone()}},"cancel"),c.createElement("button",{style:f.item,onClick:this.print},"print")))}},{key:"toggleFilter",value:function(e){var t=Number(e.target.dataset.id),n=this.state.threads.indexOf(t);n===-1?this.state.threads.push(t):this.state.threads.splice(n,1),this.filter()}},{key:"filter",value:function(){var e=this,t=this.props.project.s.reduce(function(t,n,o){var r=""!==n.h?[{values:[n.h],style:{color:"#000",backgroundColor:"#ccc"}}]:[];return r=r.concat(n.s.reduce(function(t,n,o){return n&&e.state.threads.indexOf(o)!==-1&&0!==n.w&&t.push({values:[n.h,n.w+" words"],body:n.body,style:{color:"#fff",backgroundColor:e.props.project.t[o].c}}),t},[])),r.length?t.concat(r):t},[]);this.setState({filtered:t,deselected:[]})}},{key:"select",value:function(e,t){t=this.state.deselected.indexOf(e),t===-1?this.state.deselected.push(e):this.state.deselected.splice(t,1),this.forceUpdate()}},{key:"print",value:function(){var e,t,n=this;this.props.project.s;e=this.state.filtered.reduce(function(e,t,o){return n.state.deselected.indexOf(o)===-1&&e.push(t),e},[]),t=e.reduce(function(e,t){return t.body?e+"\n\n"+t.body+"\n":e+"\n\n\n"+t.values[0]+"\n"},this.props.project.t+"\n"),s.saveAs(new Blob([t],{type:"text/plain;charset=utf-8"}),this.props.project.p+"_"+(new Date).toString()+".txt"),this.props.onDone()}}]),t}(c.Component);t.exports=p},{"../bind.js":7,"./ModalView.js":17,"file-saver":1,preact:3}],20:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("file-saver"),l=e("./FileOpener.js"),u=e("./ModalView.js"),f={scene:{display:"flex",justifyContent:"space-around",alignItems:"center",padding:"0.25rem",marginTop:"0.5rem"},title:{height:"2rem",maxWidth:"95vw",padding:"0 0.75rem",border:"none",borderBottom:"thin solid #fff",outline:"none",backgroundColor:"#ddd",fontSize:"1.2rem",color:"#000"},author:{height:"2rem",maxWidth:"95vw",padding:"0 0.75rem",border:"none",borderBottom:"thin solid #fff",outline:"none",backgroundColor:"#ddd",fontSize:"1rem",color:"#000"},item:{height:"2.5rem",padding:"0 0.75rem",border:"none",outline:"none",backgroundColor:"#fff",color:"#000",fontSize:"1.2rem",cursor:"pointer"},row:{width:"100%",display:"flex",justifyContent:"space-around",alignItems:"center",marginTop:"1.5rem",color:"#000"},rowLeft:{width:"100%",display:"flex",justifyContent:"flex-start",alignItems:"center",marginTop:"1rem",color:"#fff"},label:{color:"#000",marginRight:"1rem",width:"3.5rem",textAlign:"right"},issues:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"1.5rem",fontSize:"0.8rem",color:"#000"}},p=function(e){function t(e,n){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"render",value:function(e,t,n){var o=this;return c.createElement(u,{dismiss:e.onDone},c.createElement(l,{ref:function(e){return o.FileOpener=e?e.base:void 0},onChange:function(e){return n.do("ImportProject",{project:JSON.parse(e)})}}),c.createElement("div",{style:f.rowLeft},c.createElement("label",{style:f.label},"Title"),c.createElement("input",{style:f.title,type:"text",placeholder:"Project Title",maxLength:"40",size:"23",onInput:function(e){return n.do("ModifyProjectTitle",{title:e.target.value})},value:e.project.p})),c.createElement("div",{style:f.rowLeft},c.createElement("label",{style:f.label},"Author"),c.createElement("input",{style:f.author,type:"text",placeholder:"Author",maxLength:"40",size:"29",onInput:function(e){return n.do("ModifyProjectAuthor",{author:e.target.value})},value:e.project.a})),c.createElement("div",{style:f.row},c.createElement("span",null,e.project.w+" words"),c.createElement("span",null,e.project.c+" scenes")),c.createElement("div",{style:f.row},c.createElement("button",{style:f.item,onClick:function(){o.importProject(),e.onDone()}},"import"),c.createElement("button",{style:f.item,onClick:function(){o.exportProject(),e.onDone()}},"export"),c.createElement("button",{style:f.item,onClick:function(){e.onPrint()}},"print"),c.createElement("button",{style:Object.assign({},f.item,{color:"#f00",transition:"color 1s"}),onClick:function(e){e.target.style.color="#f00",o.timer&&(clearTimeout(o.timer),o.timer=void 0)},onMouseDown:function(e){e.target.style.color="#777",o.timer=setTimeout(n.do,1e3,"NewProject")}},"delete")),c.createElement("section",{style:f.issues},c.createElement("p",null,"Notice any bugs? Think something can be improved?"),c.createElement("a",{style:Object.assign({},f.item,{fontSize:"0.8rem",fontWeight:"600",marginTop:"0.25rem"}),href:"https://github.com/aarongoin/weave/issues",target:"_blank"},"Report issues here.")))}},{key:"importProject",value:function(){this.FileOpener.click()}},{key:"exportProject",value:function(){s.saveAs(new Blob([JSON.stringify(this.props.project)],{type:"text/plain;charset=utf-8"}),this.props.project.t+".weave")}}]),t}(c.Component);t.exports=p},{"./FileOpener.js":14,"./ModalView.js":17,"file-saver":1,preact:3}],21:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=(e("./DeleteButton.js"),e("./LocationLabel.js")),l=e("../bind.js"),u=e("./ExpandingTextarea.js"),f={box:{zIndex:9,maxWidth:"50rem",backgroundColor:"#fff",color:"#222",display:"flex",flexDirection:"column",justifyContent:"space-around",alignItems:"stretch",width:"14rem",position:"relative",top:"0.2rem",maxHeight:"13rem"},sceneHead:{fontSize:"1.1rem",height:"1.3rem",margin:"0.25rem 0.75rem"},stats:{color:"#fff",padding:"0 0.5rem",display:"flex",justifyContent:"space-around",alignItems:"center",fontSize:"0.9rem",height:"2rem"},wordcount:{fontSize:"0.9rem",padding:"0.5rem"},textarea:{fontSize:"1.1rem",margin:"0.75rem",maxHeight:"9rem"},button:{fontSize:"0.9rem",padding:"0.5rem",color:"#fff",backgroundColor:"rgba(0,0,0,0)",fontWeight:"bold",border:"none",outline:"none",cursor:"pointer"},deleteButton:{zIndex:25,fontSize:"0.9rem",position:"absolute",bottom:"-1.4rem",right:"-1.4rem",cursor:"pointer"}},p=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return l(i),i}return i(t,e),a(t,[{key:"render",value:function(e,t){var n=this,o=Object.assign({},f.box,{border:e.selected?"0.2rem solid "+e.thread.c:"0 solid rgba(0,0,0,0)",margin:e.selected?"0":"0.2rem"});return c.createElement("div",{style:o,onClick:this.onClick},c.createElement(u,{style:f.textarea,maxLength:250,onInput:this.onInput,baseHeight:"1.3rem",placeholder:"Scene Summary",value:e.scene.h,onFocus:this.onFocus,ref:function(e){return n.el=e}}),c.createElement("span",{style:Object.assign({},f.stats,{backgroundColor:e.thread.c})},c.createElement(s,{value:e.scene.l,onInput:function(t){return n.context.do("ModifySceneLocation",{sliceIndex:e.sliceIndex,sceneIndex:e.sceneIndex,newLocation:t})}}),c.createElement("button",{onClick:function(){return e.onEditScene({sliceIndex:e.sliceIndex,sceneIndex:e.sceneIndex})},style:f.button},e.scene.w>0?"edit":"write")))}},{key:"onCreateScene",value:function(e){this.newScene(e)}},{key:"onFocus",value:function(e){this.props.selected||this.select()}},{key:"onInput",value:function(e){this.context.do("ModifySceneHead",{sliceIndex:this.props.sliceIndex,sceneIndex:this.props.sceneIndex,newHead:e.target.value})}},{key:"onClick",value:function(e){e.stopPropagation(),this.props.selected||this.select()}},{key:"select",value:function(){this.props.onSelect({sliceIndex:this.props.sliceIndex,sceneIndex:this.props.sceneIndex})}}]),t}(c.Component);t.exports=p},{"../bind.js":7,"./DeleteButton.js":10,"./ExpandingTextarea.js":13,"./LocationLabel.js":16,preact:3}],22:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=0;for(h.lastIndex=0;h.test(e);)t++;return t}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=e("preact"),l=e("./ExpandingTextarea.js"),u=(e("./AppMenu.js"),e("./LocationLabel.js")),f=e("./ThreadLabel.js"),p=e("../bind.js"),d={box:{zIndex:"0",maxWidth:"50rem",backgroundColor:"#fff",color:"#222",marginTop:"1rem",marginLeft:"auto",marginRight:"auto",display:"flex",flexDirection:"column",justifyContent:"space-around",alignItems:"stretch"},top:{padding:"0.5rem",display:"flex",justifyContent:"space-around"},thread:{color:"#fff",fontSize:"0.75rem",height:"1rem",borderRadius:"1rem",marginBottom:"0.5rem",marginRight:"0.5rem",padding:"0.25rem 0.5rem 0.2rem 0.5rem"},sceneHead:{color:"#222",fontSize:"1.3rem",margin:"0.5rem 1.5rem"},sceneBody:{color:"#222",fontSize:"1.1rem",margin:"0.5rem 1.5rem"},stats:{backgroundColor:"#fff",color:"#555",fontSize:"1rem",margin:"0",padding:"0.75rem 1.5rem 0.75rem 1.5rem",display:"flex",flexDirection:"row",justifyContent:"space-around"},wc:{textAlign:"right",display:"inline-block",float:"right"},statSticky:{bottom:"0",position:"sticky"},statFree:{bottom:"auto",position:"inherit"},doneButton:{fontSize:"1rem",fontWeight:"bold",border:"none",outline:"none",backgroundColor:"rgba(0,0,0,0)",cursor:"pointer"}},h=/[\w'’]+(?!\w*>)/gim,m=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.state={threadStyle:Object.assign({},d.thread,{backgroundColor:e.thread.c}),head:e.scene.h,body:e.scene.b,wc:e.scene.w,pages:Math.round(e.scene.wc/275)||1,pageOf:1,statStyle:d.statSticky},p(i),i}return i(t,e),c(t,[{key:"render",value:function(e,t){var n=this;return s.createElement("div",{ref:this.mounted,style:d.box},s.createElement("span",{style:Object.assign({},d.top,{backgroundColor:e.thread.c})},s.createElement(f,{value:e.thread.n,onChange:function(t){return n.context.do("ModifyThreadName",{atIndex:e.sceneIndex,newName:t.target.value})}}),s.createElement(u,{value:e.scene.l,onInput:function(t){return n.context.do("ModifySceneLocation",{sliceIndex:e.sliceIndex,sceneIndex:e.sceneIndex,newLocation:t})}})),s.createElement(l,{style:d.sceneHead,maxLength:"250",onInput:function(e){return n.setState({head:e.target.value})},onChange:function(){return n.context.do("ModifySceneHead",Object.assign({newHead:n.state.head},e.coords))},value:t.head,baseHeight:"1.7em",placeholder:"Title/Summary"}),s.createElement(l,{ref:function(e){return n.body=e?e.base:void 0},style:d.sceneBody,onInput:this.onBody,value:t.body,baseHeight:"1.1em",placeholder:"Body"}),s.createElement("span",{style:Object.assign({},d.stats,t.statStyle)},s.createElement("span",{style:d.wc},t.wc+" words"),s.createElement("span",null,t.pageOf+"/"+t.pages),s.createElement("button",{style:d.doneButton,onClick:e.onDone},"done")))}},{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.onResize),window.scrollTo(0,0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize)}},{key:"onBody",value:function(e){this.setState({body:e.target.value,wc:a(e.target.value),pages:Math.round(this.state.wc/275)||1}),this.onScroll(),this.context.do("ModifySceneBody",Object.assign({newBody:this.state.body,wc:this.state.wc},this.props.coords))}},{key:"onScroll",value:function(e){this.pageCount(),this.stickyStats()}},{key:"pageCount",value:function(){var e;this.body.clientHeight>window.innerHeight?(e=Math.abs(this.body.getBoundingClientRect().top),e=e/this.body.clientHeight*(this.state.pages+1),(e=Math.ceil(e))>this.state.pages&&(e=this.state.pages)):e=1,this.setState({pageOf:e})}},{key:"stickyStats",value:function(){this.base.clientHeight>window.innerHeight-40?this.setState({statStyle:d.statSticky}):this.setState({statStyle:d.statFree})}}]),t}(s.Component);t.exports=m},{"../bind.js":7,"./AppMenu.js":9,"./ExpandingTextarea.js":13,"./LocationLabel.js":16,"./ThreadLabel.js":25,preact:3}],23:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("./SceneEditor.js"),l=e("./HeaderEditor.js"),u=(e("./NewSliceButton.js"),e("./Draggable.js")),f=e("./DropZone.js"),p={slice:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",width:"14rem"},space:{height:"14rem",width:"14rem",display:"flex",justifyContent:"center",alignItems:"flex-end"},button:{zIndex:7,padding:"0.2rem 0.6rem",fontSize:"1.2rem",color:"#fff",border:"none",outline:"none",cursor:"pointer",backgroundColor:"rgba(0,0,0,0)",textAlign:"center",margin:"0 3rem",marginBottom:"0.1rem",borderRadius:"1rem"}},d=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.state={width:0},i}return i(t,e),a(t,[{key:"render",value:function(e,t){var n=this;return c.createElement("div",{style:p.slice,ref:function(e){return n.el=e}},[e.slice.h.length?c.createElement(u,{style:Object.assign({},p.space,{height:"5.25rem",zIndex:9}),type:"header",effect:"move",payload:e.id},c.createElement(l,{id:e.id,value:e.slice.h})):c.createElement(f,{style:Object.assign({},p.space,{height:"5.25rem",zIndex:9}),type:"header",effect:"move",onDrop:function(t){return e.onHeaderDrop(t,e.id)}},c.createElement(l,{id:e.id,value:e.slice.h}))].concat(e.slice.s.map(function(t,o){return t?c.createElement(u,{style:Object.assign({},p.space,{zIndex:9}),type:"scene",effect:"move",payload:{sliceIndex:e.id,sceneIndex:o}},c.createElement(s,{sliceIndex:e.id,selected:e.selection&&e.selection.sceneIndex===o,sceneIndex:o,scene:t,thread:e.threads[o],onSelect:e.onSelect,onDeselect:e.onDeselect,onEditScene:e.onEditScene})):c.createElement(f,{style:p.space,type:"scene",effect:"move",onDrop:function(t){return e.onSceneDrop(t,{sliceIndex:e.id,sceneIndex:o})}},c.createElement("button",{style:p.button,onmouseenter:function(e){return e.target.style.backgroundColor="rgba(255,255,255,0.2)"},onmouseleave:function(e){return e.target.style.backgroundColor="rgba(0,0,0,0)"},onclick:function(){return n.context.do("NewScene",{sliceIndex:e.id,sceneIndex:o})}},"+"))})))}}]),t}(c.Component);t.exports=d},{"./Draggable.js":11,"./DropZone.js":12,"./HeaderEditor.js":15,"./NewSliceButton.js":18,"./SceneEditor.js":21,preact:3}],24:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("./DeleteButton.js"),l=e("./ExpandingTextarea.js"),u=e("../colors.js"),f=e("../bind.js"),p=e("./Draggable.js"),d=e("./DropZone.js"),h={threadHeader:{zIndex:"5",position:"relative",width:"7rem",color:"#fff",outline:"none",fontSize:"0.9rem",border:"none",textAlign:"center"},draggable:{display:"flex",flexDirection:"column",justifyContent:"center",padding:"0.5rem 0 0.5rem 0",width:"7rem"},box:{position:"relative",display:"flex",flexDirection:"column",justifyContent:"flex-end",height:"14rem"},deleteButton:{zIndex:25,fontSize:"0.9rem",position:"absolute",bottom:0,right:"-2.5rem",cursor:"pointer"}},m=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.state={value:e.thread.n,selected:!1},f(i),i}return i(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({value:e.thread.n,selected:this.state.selected})}},{key:"render",value:function(e,t){var n=this;return c.createElement(d,{style:h.box,type:"thread",effect:"move",onDrop:function(t){t>e.id&&e.onDrop(t,e.id),t<e.id-1&&e.onDrop(t,e.id-1)}},c.createElement(p,{style:Object.assign({},h.draggable,{backgroundColor:e.thread.c}),type:"thread",effect:"move",payload:e.id,onDrag:e.onDrag},c.createElement(l,{ref:function(e){return n.input=e},type:"text",style:Object.assign({},h.threadHeader,{backgroundColor:"rgba(0,0,0,0)"}),maxLength:"24",baseHeight:"0.9rem",value:t.value,placeholder:"name",onFocus:this.onFocus,onBlur:this.onBlur,onInput:function(e){n.setState({value:e.target.value}),n.context.do("ModifyThreadName",{atIndex:n.props.id,newName:e.target.value})}})),t.selected?c.createElement(s,{ref:function(e){return n.delBtn=e},style:h.deleteButton,onHold:function(){n.setState({selected:!1}),n.context.do("DeleteThread",{atIndex:e.id})}}):"")}},{key:"onDrag",value:function(e){clearTimeout(this.timer),this.timer=void 0,this.input.base.blur(),this.setState({selected:!1}),this.props.onDrag(this.props.id)}},{key:"colorToggle",value:function(){this.context.do("ModifyThreadColor",{atIndex:this.props.id,color:u.random(this.props.thread.c)}),this.timer=void 0,this.input.base.blur()}},{key:"onFocus",value:function(e){this.setState({selected:!0})}},{
key:"onBlur",value:function(e){var t=this;setTimeout(function(){t.delBtn&&!t.delBtn.timer&&t.setState({selected:!1})},100)}}]),t}(c.Component);t.exports=m},{"../bind.js":7,"../colors.js":8,"./DeleteButton.js":10,"./Draggable.js":11,"./DropZone.js":12,"./ExpandingTextarea.js":13,preact:3}],25:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s={editor:{fontSize:"0.9rem",padding:"0.5rem",height:"1rem",border:"none",outline:"none",background:"rgba(0,0,0,0)",color:"#fff"}},l=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.state={value:e.value},i}return i(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"render",value:function(e,t,n){var o=this;return c.createElement("input",{type:"text",style:e.style?Object.assign({},s.editor,e.style):s.editor,maxLength:"50",size:20,value:t.value,placeholder:"name",onInput:function(e){return o.setState({value:e.target.value})},onChange:e.onChange})}}]),t}(c.Component);t.exports=l},{preact:3}],26:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s={outer:{zIndex:"-5",position:"absolute",left:0,top:"0.5rem",minWidth:"100vw",minHeight:"100vh"},inner:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},thread:{margin:"12rem 0",height:"2rem",opacity:"0.3"},slice:{display:"inline-block",margin:"0 10.4375rem",width:"0.125rem",height:"100%",backgroundColor:"#444444"}},l=function(e){function t(e,n){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"render",value:function(e,t){return c.createElement("div",{"data-is":"WeaveBackground",style:Object.assign({},s.outer,{top:e.menuOffset,width:21*(e.slices+1)-5+"rem",height:14*(e.threads.length+1)+16+"rem"})},c.createElement("div",{style:Object.assign({},s.inner,{left:"7rem",width:"auto"})},Array(e.slices).fill(0).map(function(e,t){return c.createElement("div",{style:s.slice}," ")})),c.createElement("div",{style:s.inner},c.createElement("div",{style:Object.assign({},s.thread,{backgroundColor:"#000",margin:"3.25rem 0"})}," "),e.threads.map(function(e,t){return c.createElement("div",{style:Object.assign({},s.thread,{backgroundColor:e.c})}," ")})))}}]),t}(c.Component);t.exports=l},{preact:3}],27:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("./ThreadHeader.js"),l=e("../colors.js"),u=e("../bind.js"),f={outer:{position:"absolute",left:0,minWidth:"100vw",minHeight:"100vh"},threads:{position:"absolute",top:"0.25rem",width:"7rem",minHeight:"100vh"},thread:{display:"flex",flexDirection:"column",justifyContent:"flex-end",position:"relative",height:"13.75rem"},scenes:{zIndex:"11",position:"absolute",backgroundColor:"#111",left:0,height:"2rem",paddingLeft:"7rem",minWidth:"100vw"},sliceButton:{margin:"0 1.375rem",fontSize:"1.2rem",color:"#fff",border:"none",outline:"none",cursor:"pointer",width:"1.25rem",height:"1.25rem",textAlign:"center",borderRadius:"1rem",backgroundColor:"rgba(0,0,0,0)"},firstSliceButton:{margin:"0 0.375rem",fontSize:"1.2rem",color:"#fff",border:"none",outline:"none",cursor:"pointer",width:"1.25rem",height:"1.25rem",textAlign:"center",borderRadius:"1rem",backgroundColor:"rgba(0,0,0,0)"},threadBtn:{height:"2rem",fontSize:"1.2rem",color:"#fff",border:"none",outline:"none",cursor:"pointer",textAlign:"center",padding:"0.5rem 0.5rem",backgroundColor:"rgba(0,0,0,0)",width:"100%"},header:function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({zIndex:0,display:"flex",justifyContent:"center",alignItems:"center",height:"2rem",fontSize:"0.9rem",color:"#fff",border:"none",backgroundColor:"rgba(0,0,0,0)",width:"100%"},"border","none")},p=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.state={x:0},u(i),i}return i(t,e),a(t,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.onScroll)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.onScroll)}},{key:"render",value:function(e,t){var n=this;return c.createElement("div",{"data-is":"WeaveHeaders",style:f.outer},c.createElement("div",{"data-is":"ThreadHeaders",style:Object.assign({},f.threads,{left:t.x,height:14*(e.threads.length+1)+16+"rem",backgroundColor:"rgba(0,0,0,0)",zIndex:8})},[c.createElement("div",{style:Object.assign({},f.thread,{height:"5rem"})},c.createElement("span",{style:f.header}," "))].concat(e.threads.map(function(e,t){return c.createElement(s,{id:t,thread:e,onDrag:function(e){return n.dragging=e},onDrop:n.onThreadDrop})}).concat([c.createElement("div",{style:f.thread},c.createElement("button",{onClick:function(e){return n.context.do("NewThread",{color:e.target.style.backgroundColor})},style:f.threadBtn,onMouseenter:function(e){return e.target.style.backgroundColor=l.random()},onMouseleave:function(e){return e.target.style.backgroundColor="rgba(0,0,0,0)"}},"+"))]))))}},{key:"onScroll",value:function(){this.setState({x:document.body.scrollLeft})}},{key:"onThreadDrop",value:function(e,t){this.context.do("MoveThread",{fromIndex:e,toIndex:t})}}]),t}(c.Component);t.exports=p},{"../bind.js":7,"../colors.js":8,"./ThreadHeader.js":24,preact:3}],28:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("../bind.js"),l=e("./SliceView.js"),u=e("./WeaveHeaders.js"),f=e("./WeaveBackground.js"),p=e("./NewSliceButton.js"),d={weave:{marginLeft:"7rem",display:"inline-flex"},scenes:{display:"flex",justifyContent:"flex-start",alignItems:"flex-start"}},h=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s(i),i}return i(t,e),a(t,[{key:"render",value:function(e,t){var n=this;return c.createElement("div",{"data-is":"WeaveView",style:d.weave,onclick:e.onDeselect},c.createElement(u,{slices:e.project.s,threads:e.project.t,windowWidth:e.windowWidth}),c.createElement(f,{slices:e.project.s.length,threads:e.project.t}),c.createElement("div",{"data-is":"Weave",style:d.scenes},[c.createElement(p,{halfWidth:!0,onClick:function(){return n.context.do("NewSlice",{atIndex:0})}})].concat(e.project.s.map(function(t,o){return[c.createElement(l,{id:o,selection:e.focusedScene&&e.focusedScene.sliceIndex===o?e.focusedScene:null,slice:t,threads:e.project.t,onSelect:e.onSelect,onDeselect:e.onDeselect,onEditScene:e.onEditScene,onSceneDrag:n.onSceneDrag,onSceneDrop:n.onSceneDrop,onHeaderDrop:n.onHeaderDrop}),c.createElement(p,{halfWidth:!1,onClick:function(){return n.context.do("NewSlice",{atIndex:o+1})}})]}))))}},{key:"onHeaderDrop",value:function(e,t){this.context.do("MoveSliceHeader",{from:e,to:t})}},{key:"onSceneDrag",value:function(e){this.setState({selection:null})}},{key:"onSceneDrop",value:function(e,t){this.context.do("MoveScene",{from:e,to:t})}}]),t}(c.Component);t.exports=h},{"../bind.js":7,"./NewSliceButton.js":18,"./SliceView.js":23,"./WeaveBackground.js":26,"./WeaveHeaders.js":27,preact:3}],29:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("preact"),s=e("./ModalView.js"),l=e("../bind.js"),u={span:{width:"30rem",display:"flex",justifyContent:"space-around",alignItems:"center",marginBottom:"1rem"},h1:{color:"#000",display:"inline"},h3:{color:"#000",display:"inline",fontWeight:"100"},section:{width:"30rem",color:"#000",fontSize:"1.1rem",fontWeight:"400",marginBottom:"0.75rem"},p:{marginBottom:"0.75rem"},warnings:{width:"30rem",color:"#f00",fontSize:"1.1rem",fontWeight:"600",marginTop:"0.75rem",marginBottom:"0.75rem"}},f=function(e){function t(e,n){o(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return l(i),i}return i(t,e),a(t,[{key:"render",value:function(e,t){this.select;return c.createElement(s,{dismiss:e.onDone},c.createElement("span",{style:u.span},c.createElement("h1",{style:u.h1},"Welcome to Weave"),c.createElement("h3",{style:u.h3},"alpha")),c.createElement("section",{style:u.section},c.createElement("p",{style:u.p},"Weave is a web app for writers."),c.createElement("p",{style:u.p},"Build up the fabric of your story by creating threads for your characters, and laying out scenes in time."),c.createElement("p",{style:u.p},"Scaffold your story by summarizing each scene, and setting it's location."),c.createElement("p",{style:u.p},"Drag and drop threads and scenes to place them right where you want them."),c.createElement("p",{style:u.p},"Write your scenes in a simple, distraction-free text editor."),c.createElement("p",{style:u.p},"Click the Project Title Button (in the top-left corner), to access the Project Menu. From here you can modify the Project Title and Author, Import/Export your project, Print your project, or Delete your project and start anew."),c.createElement("p",{style:u.p},"The Print Menu allows you to select the threads you wish to print from. Any scenes in selected threads with written words will be auto-selected for printing--along with any Headers. Toggle any scene or header off or on as you wish, and Print when you're ready.")),c.createElement("section",{style:u.warnings},c.createElement("p",{style:u.p},"Weave stores your project inside your browser's Local Storage, so if you clear your browser history and cache: your project may be deleted as well. Be sure to Export your project regularly!"),c.createElement("p",{style:u.p},"Your browser limits Local Storage by size, so if your project grows to over 1 million written words, you should split it up into seperate projects.")))}}]),t}(c.Component);t.exports=f},{"../bind.js":7,"./ModalView.js":17,preact:3}],30:[function(e,t,n){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),o=1;o<arguments.length;o++){var r=arguments[o];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])}return n})},{}]},{},[4]);
